<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="St. Jude Cloud" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>FlagFilter - St. Jude Cloud Bioinformatics Workflows</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "FlagFilter";
        var mkdocs_page_input_path = "workflows/flag_filter.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> St. Jude Cloud Bioinformatics Workflows
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../build_for_dnanexus/">Building WDL workflows for DNAnexus</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Tasks</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/arriba/">Arriba</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/bwa/">Bwa</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/cellranger/">Cellranger</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/deeptools/">Deeptools</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/estimate/">Estimate</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/fastqc/">Fastqc</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/fq/">Fq</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/gatk4/">Gatk4</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/htseq/">Htseq</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/kraken2/">Kraken2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/librarian/">librarian</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/md5sum/">Md5sum</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/mosdepth/">Mosdepth</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/multiqc/">Multiqc</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/ngsderive/">Ngsderive</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/picard/">Picard</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/qualimap/">Qualimap</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/read_group/">Read group</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/sambamba/">Sambamba</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/samtools/">Samtools</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/star/">Star</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tasks/util/">Utilities</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Workflows</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../10x-bam-to-fastqs/">Cell Ranger BAM to FASTQs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ESTIMATE/">ESTIMATE</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bam-to-fastqs/">Bam to fastqs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bwa-db-build/">Bwa db build</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dnaseq-core/">Dnaseq core</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dnaseq-standard-fastq/">Dnaseq standard fastq</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dnaseq-standard/">Dnaseq standard</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">FlagFilter</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#example-input-json">Example input JSON</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#explanation">Explanation</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#validate_flag_filter">validate_flag_filter</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#inputs">Inputs</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#required">Required</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#outputs">Outputs</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#validate_string_is_12bit_oct_dec_or_hex">validate_string_is_12bit_oct_dec_or_hex</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#inputs_1">Inputs</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#required_1">Required</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#outputs_1">Outputs</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gatk-reference/">Gatk reference</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../make-qc-reference/">Make qc reference</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../markdups-post/">MarkDuplicates Post</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../quality-check-standard/">Quality check standard</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../rnaseq-variant-calling/">Rnaseq variant calling</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../samtools-merge/">Samtools merge</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scrnaseq-standard/">Scrnaseq standard</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../star-db-build/">Star db build</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">St. Jude Cloud Bioinformatics Workflows</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Workflows</li>
      <li class="breadcrumb-item active">FlagFilter</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/stjudecloud/workflows/edit/master/docs/workflows/flag_filter.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="flagfilter">FlagFilter</h1>
<p>A struct to represent the filtering flags used in various <code>samtools</code> commands.
The order of precedence is <code>include_if_all</code>, <code>exclude_if_any</code>, <code>include_if_any</code>,
and <code>exclude_if_all</code>.
These four fields correspond to the samtools flags
<code>-f</code>, <code>-F</code>, <code>--rf</code>, and <code>-G</code> respectively.
The values of these fields are strings that represent a 12bit bitwise flag.
These strings must evaluate to an integer less than 4096 (2^12).
They can be in octal, decimal, or hexadecimal format.
Please see the <code>meta.help</code> of <code>validate_string_is_12bit_oct_dec_or_hex</code>
for more information on the valid formats.</p>
<p>The <code>validate_flag_filter</code> workflow can be used to validate a <code>FlagFilter</code> struct.
<strong>WARNING</strong> The <code>validate_flag_filter</code> workflow will only check that all the fields
can be parsed as integers less than 4096. It will not check if the flags are
sensible input to <code>samtools fastq</code>.
<code>samtools fastq</code> also employs very little error checking on the flags.
So it is possible to pass in flags that produce nonsensical output.
For example, it is possible to pass in flags that produce no output.
<strong>Please exhibit caution while modifying any default values of a <code>FlagFilter</code>.</strong></p>
<p>We suggest using the Broad Institute's SAM flag explainer to construct the flags.
Find it <a href="https://broadinstitute.github.io/picard/explain-flags.html">here</a>.</p>
<h2 id="example-input-json">Example input JSON</h2>
<pre><code class="language-json">{
   &quot;flags&quot;: {
       &quot;include_if_all&quot;: &quot;0x3&quot;,
       &quot;exclude_if_any&quot;: &quot;0xF04&quot;,
       &quot;include_if_any&quot;: &quot;0x0&quot;,
       &quot;exclude_if_all&quot;: &quot;0x0&quot;
   }
}
</code></pre>
<h3 id="explanation">Explanation</h3>
<p>The above example JSON represents a <code>FlagFilter</code> struct
being passed to parameter named <code>flags</code>.
The <code>include_if_all</code> field is set to <code>0x3</code> which is <code>3</code> in decimal.
The <code>exclude_if_any</code> field is set to <code>0xF04</code> which is <code>3844</code> in decimal.
The <code>include_if_any</code> field is set to <code>0x0</code> which is <code>0</code> in decimal.
The <code>exclude_if_all</code> field is set to <code>0x0</code> which is <code>0</code> in decimal.</p>
<p><code>3</code> in decimal can be represented as <code>000000000011</code> in 12bit binary.
This number means that to be included a read must have the 1st and 2nd bits set.
Those bits correspond to the <code>read paired</code> and <code>read mapped in proper pair</code> flags.</p>
<p><code>3844</code> in decimal can be represented as <code>111100000100</code> in 12bit binary.
This number means that to be excluded a read must have <strong>any</strong> of the
3rd, 9th, 10th, 11th, or 12th bits set.
We won't go through what all those bits mean here, but you can find
the meanings of the bits in the
<a href="https://broadinstitute.github.io/picard/explain-flags.html">SAM flag explainer</a>.
In short, those are all flags corresponding to the quality of the read
and them being <code>true</code> may indicate that the read is of low quality and
should be excluded.</p>
<h2 id="validate_flag_filter">validate_flag_filter</h2>
<dl>
<dt>description</dt>
<dd>Validates a FlagFilter struct.</dd>
<dt>output</dt>
<dd>{'check': 'Dummy output to enable caching.'}</dd>
</dl>
<h3 id="inputs">Inputs</h3>
<h4 id="required">Required</h4>
<ul>
<li><code>flags</code> (FlagFilter, <strong>required</strong>): FlagFilter struct to validate</li>
<li><code>validate_exclude_if_all._runtime</code> (Any, <strong>required</strong>)</li>
<li><code>validate_exclude_if_any._runtime</code> (Any, <strong>required</strong>)</li>
<li><code>validate_include_if_all._runtime</code> (Any, <strong>required</strong>)</li>
<li><code>validate_include_if_any._runtime</code> (Any, <strong>required</strong>)</li>
</ul>
<h3 id="outputs">Outputs</h3>
<ul>
<li><code>check</code> (String)</li>
</ul>
<h2 id="validate_string_is_12bit_oct_dec_or_hex">validate_string_is_12bit_oct_dec_or_hex</h2>
<dl>
<dt>description</dt>
<dd>Validates that a string is a octal, decimal, or hexadecimal number and less than 2^12.</dd>
<dt>help</dt>
<dd>Hexadecimal numbers must be prefixed with '0x' and only contain the characters [0-9A-F] to be valid (i.e. [a-f] is not allowed). Octal number must start with '0' and only contain the characters [0-7] to be valid. And decimal numbers must start with a digit between 1-9 and only contain the characters [0-9] to be valid.</dd>
<dt>outputs</dt>
<dd>{'check': 'Dummy output to enable caching.'}</dd>
</dl>
<h3 id="inputs_1">Inputs</h3>
<h4 id="required_1">Required</h4>
<ul>
<li><code>_runtime</code> (Any, <strong>required</strong>)</li>
<li><code>number</code> (String, <strong>required</strong>): The number to validate. See task <code>meta.help</code> for accepted formats.</li>
</ul>
<h3 id="outputs_1">Outputs</h3>
<ul>
<li><code>check</code> (String)</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../dnaseq-standard/" class="btn btn-neutral float-left" title="Dnaseq standard"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../gatk-reference/" class="btn btn-neutral float-right" title="Gatk reference">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>© 2020-Present St. Jude Children's Research Hospital</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/stjudecloud/workflows" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../dnaseq-standard/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../gatk-reference/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
