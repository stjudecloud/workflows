<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="St. Jude Cloud" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Kraken2 - St. Jude Cloud Bioinformatics Workflows</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Kraken2";
        var mkdocs_page_input_path = "tasks/kraken.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> St. Jude Cloud Bioinformatics Workflows
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../build_for_dnanexus/">Building WDL workflows for DNAnexus</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Tasks</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../bwa/">BWA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cellranger/">Cellranger</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../deeptools/">Deeptools</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../estimate/">ESTIMATE</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../fastqc/">FastQC</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../fq/">FQ</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../htseq/">HTSeq</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Kraken2</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#download_taxonomy">download_taxonomy</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#inputs">Inputs</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#defaults">Defaults</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#outputs">Outputs</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#download_library">download_library</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#inputs_1">Inputs</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#required">Required</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#defaults_1">Defaults</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#outputs_1">Outputs</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#create_library_from_fastas">create_library_from_fastas</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#inputs_2">Inputs</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#required_1">Required</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#defaults_2">Defaults</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#outputs_2">Outputs</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#build_db">build_db</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#inputs_3">Inputs</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#required_2">Required</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#defaults_3">Defaults</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#outputs_3">Outputs</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#kraken">kraken</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#inputs_4">Inputs</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#required_3">Required</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#defaults_4">Defaults</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#outputs_4">Outputs</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../md5sum/">Md5sum</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mosdepth/">Mosdepth</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../multiqc/">MultiQC</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ngsderive/">ngsderive</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../picard/">Picard</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../qualimap/">QualiMap</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../samtools/">SAMtools</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../star/">STAR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../util/">Utilities</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Workflows</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../workflows/10x-bam-to-fastqs/">Cell Ranger Bam to FastQs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../workflows/ESTIMATE/">ESTIMATE</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../workflows/bam-to-fastqs/">Bam to FastQs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../workflows/bwa-db-build/">BWA DB build</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../workflows/calc-gene-lengths/">Calculate Gene Lengths</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../workflows/make-qc-reference/">Make QC Reference</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../workflows/markdups-post/">MarkDuplicates Post</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../workflows/quality-check-standard/">Quality Check Standard</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../workflows/scrnaseq-standard/">Scrnaseq standard</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../workflows/star-db-build/">STAR DB build</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">St. Jude Cloud Bioinformatics Workflows</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
          <li>Tasks &raquo;</li>
      <li>Kraken2</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/stjudecloud/workflows/edit/master/docs/tasks/kraken.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="kraken2">Kraken2</h1>
<p>Methods for bootstrapping and running <a href="https://github.com/DerrickWood/kraken2">Kraken2</a></p>
<h2 id="download_taxonomy">download_taxonomy</h2>
<dl>
<dt>description</dt>
<dd>This WDL task downloads the NCBI taxonomy which Kraken2 uses to create a tree and taxon map during the database build.</dd>
</dl>
<h3 id="inputs">Inputs</h3>
<h4 id="defaults">Defaults</h4>
<ul>
<li><code>disk_size_gb</code> (Int, default=60): Disk space to allocate for task</li>
<li><code>max_retries</code> (Int, default=3): Number of times to retry in case of failure</li>
<li><code>memory_gb</code> (Int, default=4): RAM to allocate for task</li>
<li><code>protein</code> (Boolean, default=false): Construct a protein database?</li>
</ul>
<h3 id="outputs">Outputs</h3>
<ul>
<li><code>taxonomy</code> (File)</li>
</ul>
<h2 id="download_library">download_library</h2>
<dl>
<dt>description</dt>
<dd>This WDL task downloads a predefined library of reference genomes from NCBI. Detailed organism list for libraries (except nt) available at: https://ftp.ncbi.nlm.nih.gov/genomes/refseq/.</dd>
</dl>
<h3 id="inputs_1">Inputs</h3>
<h4 id="required">Required</h4>
<ul>
<li><code>library_name</code> (String, <strong>required</strong>); <strong>description</strong>: Library to download. Note that <code>protein</code> must equal <code>true</code> if downloading the <code>nr</code> library, and <code>protein</code> must equal <code>false</code> if downloading the <code>UniVec</code> or <code>UniVec_Core</code> library.; <strong>choices</strong>: ['archaea', 'bacteria', 'plasmid', 'viral', 'human', 'fungi', 'plant', 'protozoa', 'nt', 'nr', 'UniVec', 'UniVec_Core']</li>
</ul>
<h4 id="defaults_1">Defaults</h4>
<ul>
<li><code>max_retries</code> (Int, default=3): Number of times to retry in case of failure</li>
<li><code>memory_gb</code> (Int, default=4): RAM to allocate for task, specified in GB</li>
<li><code>modify_disk_size_gb</code> (Int, default=0): Add to or subtract from dynamic disk space allocation, specified in GB. Default disk size is determined dynamically based on <code>library_name</code>. Note that the default sizes are adequate as of April 2023, but new genomes are constantly being added to the NCBI database. More disk space may be required depending on when in the future this task is run.</li>
<li><code>protein</code> (Boolean, default=false): Construct a protein database?</li>
</ul>
<h3 id="outputs_1">Outputs</h3>
<ul>
<li><code>library</code> (File)</li>
</ul>
<h2 id="create_library_from_fastas">create_library_from_fastas</h2>
<dl>
<dt>description</dt>
<dd>This WDL task adds custom entries from FASTA files to a Kraken2 DB.</dd>
</dl>
<h3 id="inputs_2">Inputs</h3>
<h4 id="required_1">Required</h4>
<ul>
<li><code>fastas</code> (Array[File], <strong>required</strong>): Array of gzipped FASTA files. Each FASTA sequence ID must contain either an NCBI accession number or an explicit assignment of the taxonomy ID using <code>kraken:taxid</code></li>
</ul>
<h4 id="defaults_2">Defaults</h4>
<ul>
<li><code>max_retries</code> (Int, default=1): Number of times to retry in case of failure</li>
<li><code>memory_gb</code> (Int, default=4): RAM to allocate for task, specified in GB</li>
<li><code>modify_disk_size_gb</code> (Int, default=0): Add to or subtract from dynamic disk space allocation. Default disk size is determined by the size of the inputs. Specified in GB.</li>
<li><code>protein</code> (Boolean, default=false): Construct a protein database?</li>
</ul>
<h3 id="outputs_2">Outputs</h3>
<ul>
<li><code>custom_library</code> (File)</li>
</ul>
<h2 id="build_db">build_db</h2>
<dl>
<dt>description</dt>
<dd>This WDL task builds a custom Kraken2 database.</dd>
</dl>
<h3 id="inputs_3">Inputs</h3>
<h4 id="required_2">Required</h4>
<ul>
<li><code>tarballs</code> (Array[File], <strong>required</strong>): Tarballs containing the NCBI taxonomy (generated by the <code>download_taxonomy</code> task) and at least one library (generated by the <code>download_library</code> task). Tarballs must not have a root directory.</li>
</ul>
<h4 id="defaults_3">Defaults</h4>
<ul>
<li><code>db_name</code> (String, default="kraken2_db"): Name for output in compressed, archived format. The suffix <code>.tar.gz</code> will be added.</li>
<li><code>kmer_len</code> (Int, default=if protein then 15 else 35): K-mer length in bp that will be used to build the database</li>
<li><code>max_db_size_gb</code> (Int, default=-1): Maximum number of GBs for Kraken 2 hash table; if the Kraken 2 estimator determines more would normally be needed, the reference library will be downsampled to fit.</li>
<li><code>max_retries</code> (Int, default=1): Number of times to retry in case of failure</li>
<li><code>minimizer_len</code> (Int, default=if protein then 12 else 31): Minimizer length in bp that will be used to build the database</li>
<li><code>minimizer_spaces</code> (Int, default=if protein then 0 else 7): Number of characters in minimizer that are ignored in comparisons</li>
<li><code>modify_disk_size_gb</code> (Int, default=0): Add to or subtract from dynamic disk space allocation. Default disk size is determined by the size of the inputs. Specified in GB.</li>
<li><code>modify_memory_gb</code> (Int, default=0): Add to or subtract from dynamic memory allocation. Default memory is determined by the size of the inputs. Specified in GB.</li>
<li><code>ncpu</code> (Int, default=1): Number of cores to allocate for task</li>
<li><code>protein</code> (Boolean, default=false): Construct a protein database?</li>
<li><code>use_all_cores</code> (Boolean, default=false): Use all cores. Recommended for cloud environments. Not recommended for cluster environments.</li>
</ul>
<h3 id="outputs_3">Outputs</h3>
<ul>
<li><code>built_db</code> (File)</li>
</ul>
<h2 id="kraken">kraken</h2>
<dl>
<dt>description</dt>
<dd>This WDL tool runs Kraken2 on a pair of fastq files.</dd>
</dl>
<h3 id="inputs_4">Inputs</h3>
<h4 id="required_3">Required</h4>
<ul>
<li><code>db</code> (File, <strong>required</strong>): Kraken2 database. Can be generated with <code>make-qc-reference.wdl</code>. Must be a tarball without a root directory.</li>
<li><code>read_one_fastq_gz</code> (File, <strong>required</strong>): Gzipped FastQ file with 1st reads in pair</li>
<li><code>read_two_fastq_gz</code> (File, <strong>required</strong>): Gzipped FastQ file with 2nd reads in pair</li>
</ul>
<h4 id="defaults_4">Defaults</h4>
<ul>
<li><code>max_retries</code> (Int, default=1): Number of times to retry in case of failure</li>
<li><code>min_base_quality</code> (Int, default=0): Minimum base quality used in classification</li>
<li><code>modify_disk_size_gb</code> (Int, default=0): Add to or subtract from dynamic disk space allocation. Default disk size is determined by the size of the inputs. Specified in GB.</li>
<li><code>modify_memory_gb</code> (Int, default=0): Add to or subtract from dynamic memory allocation. Default memory is determined by the size of the inputs. Specified in GB.</li>
<li><code>ncpu</code> (Int, default=1): Number of cores to allocate for task</li>
<li><code>prefix</code> (String, default=sub(basename(read_one_fastq_gz),"([_.]R[12])?(.subsampled)?.(fastq|fq)(.gz)?$","")): Prefix for the Kraken2 output files. The extensions <code>.kraken2.txt</code> and <code>.kraken2.sequences.txt.gz</code> will be added.</li>
<li><code>store_sequences</code> (Boolean, default=false): Store and output main Kraken2 output in addition to the summary report</li>
<li><code>use_all_cores</code> (Boolean, default=false): Use all cores? Recommended for cloud environments. Not recommended for cluster environments.</li>
<li><code>use_names</code> (Boolean, default=true): Print scientific names instead of just taxids</li>
</ul>
<h3 id="outputs_4">Outputs</h3>
<ul>
<li><code>report</code> (File)</li>
<li><code>sequences</code> (File?)</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../htseq/" class="btn btn-neutral float-left" title="HTSeq"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../md5sum/" class="btn btn-neutral float-right" title="Md5sum">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>© 2020-Present St. Jude Children's Research Hospital</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/stjudecloud/workflows" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../htseq/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../md5sum/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
