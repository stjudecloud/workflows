- name: build_star_db
  tags:
    - star
    - reference
  command: >-
    ./developer_scripts/run_sprocket_or_miniwdl.sh -t build_star_db tools/star.wdl reference_fasta=tests/input/GRCh38.chrY_chrM.fa gtf=tests/input/gencode.v31.chrY_chrM.gtf.gz
  files:
    - path: output/outputs.json
      contains:
      - star_db.tar.gz

- name: star_alignment_PE_1_pair
  tags:
    - star
  command: >-
    ./developer_scripts/run_sprocket_or_miniwdl.sh -t alignment -i tests/tools/input_json/star_alignment_PE_1_pair.json tools/star.wdl
  files:
    - path: output/outputs.json
      contains:
      - test.Log.final.out
      - test.Aligned.out.bam

- name: star_alignment_PE_2_pairs
  tags:
    - star
  command: >-
    ./developer_scripts/run_sprocket_or_miniwdl.sh -t alignment -i tests/tools/input_json/star_alignment_PE_2_pairs.json tools/star.wdl
  files:
    - path: output/outputs.json
      contains:
      - test.Log.final.out
      - test.Aligned.out.bam

- name: star_alignment_SE
  tags:
    - star
  command: >-
    ./developer_scripts/run_sprocket_or_miniwdl.sh -t alignment tools/star.wdl read_one_fastqs_gz=tests/input/test_R1.fq.gz read_groups=\"ID:foo\" prefix=test star_db_tar_gz="tests/input/star_db.chrY_chrM.tar.gz"
  files:
    - path: output/outputs.json
      contains:
      - test.Log.final.out
      - test.Aligned.out.bam